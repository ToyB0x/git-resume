# Deep Research UI設計

> **注意**: このUI設計ドキュメントは、アーキテクチャ設計を検討する過程で作成された参考資料です。アーキテクチャの検証や具体化のために作成されたものであり、最終的な実装の詳細を規定するものではありません。抽象と具体を往復して検討した結果の一部として位置づけられます。

## UI概要

Deep ResearchのUIは、モダンでイマーシブなユーザー体験を提供しながら、複雑な調査プロセスを直感的に操作できるように設計されています。ダークテーマをベースにしたグラデーションリッチなデザインで、ユーザーが調査プロセスに集中できる環境を提供します。特に、10秒以内に調査計画を表示し、ユーザーがいつでも安全に離脱できる機能に焦点を当てています。

このUIは、アーキテクチャで定義された2段階調査プロセスを視覚的に表現し、ユーザーが調査の進行状況を理解しやすくするように設計されています：

1. **1次調査（調査計画段階）**: 10秒以内の高速レスポンスで基本情報と調査計画を表示
2. **2次調査（詳細分析段階）**: バックグラウンドで実行される詳細分析の進捗と結果を表示

## 画面構成

### 1. ホーム画面

**URL**: `/`

![ホーム画面](../../assets/images/deep-research-home.png)

**主要コンポーネント:**
- ヘッダー: グラデーションテキストのロゴ、ナビゲーションメニュー
- 検索フォーム: GitHub User名入力フィールドと調査開始ボタン（グラデーションエフェクト付き）
- 最近の調査: 過去に実行した調査のリスト（ログインユーザーのみ）
- フッター: サポート情報、利用規約へのリンク

**インタラクション:**
- ユーザー名入力フィールドのフォーカス効果（リングエフェクト）
- 検索ボタンのホバーエフェクト（グラデーション変化）
- 最近の調査項目をクリックで詳細画面に遷移

**技術実装:**
- CloudFlare Pages上でのReact + TypeScript
- Tailwind CSSによるスタイリング
- React Routerによるクライアントサイドルーティング

### 2. 調査計画画面

**URL**: `/github/:username/plan`

![調査計画画面](../../assets/images/deep-research-plan.png)

**主要コンポーネント:**
- 基本情報セクション: 入力されたGitHub User名と基本プロフィール（グラスモーフィズムカード）
- 調査計画概要: 実行予定の調査ステップのリスト（アニメーションエフェクト付き）
- 予想時間表示: 各ステップと全体の予想所要時間
- アクションボタン: グラデーションエフェクト付きの「実行」「キャンセル」「詳細設定」ボタン
- 10秒カウントダウンタイマー: グラデーションプログレスバー

**インタラクション:**
- 各調査ステップの展開/折りたたみ（スムーズなアニメーション）
- 「詳細設定」クリックでオーバーレイパネル表示
- 「実行」ボタンクリックでリップルエフェクトと調査開始

**技術実装:**
- CloudFlare Workersからの1次調査結果の表示
- GitHub APIから取得した基本プロフィール情報の表示
- 10秒以内のレスポンス時間を保証するための最適化

### 3. 調査進行画面

**URL**: `/github/:username/progress`

![調査進行画面](../../assets/images/deep-research-progress.png)

**主要コンポーネント:**
- 進捗バー: グラデーションプログレスバーで全体の進行状況を視覚的に表示
- ステップリスト: 各調査ステップの状態（待機中/進行中/完了/エラー）をアイコンとカラーで表示
- リアルタイム更新エリア: 現在実行中の処理の詳細（アニメーションエフェクト付き）
- 部分結果表示: 完了したステップの結果をリアルタイムで表示（フェードインエフェクト）
- 離脱安全インジケーター: パルスアニメーション付きアイコンでユーザーがいつでも安全に離脱できることを示す

**インタラクション:**
- 完了したステップをクリックで詳細結果を展開（スムーズなアニメーション）
- 「一時停止」ボタンで調査を一時停止可能（状態変化アニメーション）
- 「中止」ボタンで調査を中止可能（確認ダイアログ）
- 画面を離れても調査は継続（バックグラウンド処理）
- 「ブックマーク」ボタンで現在の調査をブックマークに追加（成功通知）

**技術実装:**
- Pollingによるリアルタイム進捗更新
- Cloud Run Jobsの進捗状態の表示
- 以下の進捗状態を視覚的に表示:
  - リポジトリを検索中
  - リポジトリをClone中
  - リポジトリの活動を分析中
  - Resumeの作成中
  - Resume作成済み

### 4. 調査結果画面

**URL**: `/github/:username/results`

![調査結果画面](../../assets/images/deep-research-results.png)

**主要コンポーネント:**
- タブナビゲーション: グラデーションアンダーラインで現在のタブを強調表示
  - 基本情報
  - リポジトリ分析
  - コントリビューション
  - ネットワーク
  - 技術スタック
- データビジュアライゼーション: グラデーションカラーを使用したグラフ、チャート、ネットワーク図
- 詳細情報テーブル: 構造化されたデータの表示（ホバーエフェクト付き行）
- アクションボタン: グラデーションエフェクト付きの「エクスポート」「共有」「新しい調査」ボタン

**インタラクション:**
- タブ切り替えでスムーズなトランジションエフェクト
- グラフの拡大/縮小、フィルタリング（インタラクティブコントロール）
- テーブルのソート、フィルタリング（アニメーションエフェクト）
- 「エクスポート」ボタンでフォーマット選択メニュー表示（オーバーレイパネル）

**技術実装:**
- マークダウン形式のResumeのレンダリング
- データベース（Neon.tech）から取得した2次調査結果の表示
- 30日間のキャッシュ期間内であれば即時表示

### 5. その他のルート

**エラー画面**: `/error`
- エラー情報の表示
- トラブルシューティングのガイダンス
- ホームに戻るボタン

**ユーザー設定画面**: `/settings`
- 通知設定
- 表示設定
- アカウント情報

**ヘルプ・サポート画面**: `/help`
- ヘルプドキュメント
- よくある質問（FAQ）
- サポート連絡先

## ルーティング設計

React Router（SPA Mode）を使用して、以下のルーティング構造を実装します：
(React Router 7 以降の場合は route.ts などで代替実装をしてください)

```jsx
<Routes>
  <Route path="/" element={<HomePage />} />
  <Route path="/github/:username/plan" element={<PlanPage />} />
  <Route path="/github/:username/progress" element={<ProgressPage />} />
  <Route path="/github/:username/results" element={<ResultsPage />} />
  <Route path="/error" element={<ErrorPage />} />
  <Route path="/settings" element={<SettingsPage />} />
  <Route path="/help" element={<HelpPage />} />
  <Route path="*" element={<NotFoundPage />} />
</Routes>
```

URLパラメータ`:username`はGitHub User名を表し、これによって特定のユーザーの調査計画、進捗状況、結果にアクセスできます。また、ユーザーが直接URLを入力して特定の画面にアクセスした場合も、適切な状態チェックを行い、必要に応じて適切な画面にリダイレクトします。

例えば、ユーザーが `/github/octocat/results` にアクセスした場合、システムは以下の処理を行います：

1. データベースで `octocat` の調査結果が存在するか確認
2. 結果が存在する場合は結果画面を表示
3. 結果が存在せず進行中の場合は進捗画面 (`/github/octocat/progress`) にリダイレクト
4. 調査が未実行の場合は計画画面 (`/github/octocat/plan`) にリダイレクト

これにより、ユーザーは常に適切な画面を見ることができ、システムの現在の状態を理解できます。

## レスポンシブデザイン

すべての画面は以下のブレークポイントでレスポンシブに対応:

- モバイル: 320px - 767px
- タブレット: 768px - 1023px
- デスクトップ: 1024px以上

**モバイル対応:**
- 単一カラムレイアウト
- タブをアコーディオンに変更
- タッチフレンドリーなボタンサイズ
- スワイプジェスチャーのサポート

## カラーパレット

- **ベースカラー**: 
  - ダークテーマ: #0F172A (bg-gray-950)
  - グラデーション背景: #0F172A → #172554 → #581C87 (from-gray-950 via-blue-950 to-purple-950)

- **アクセントカラー**: 
  - プライマリグラデーション: #22D3EE → #3B82F6 → #9333EA (from-cyan-400 via-blue-500 to-purple-600)
  - セカンダリグラデーション: #6366F1 → #8B5CF6 → #D946EF (from-indigo-500 via-purple-500 to-pink-500)

- **UI要素**:
  - カード背景: rgba(0, 0, 0, 0.6) (bg-black/60)
  - ボーダー: #1F2937 (border-gray-800)
  - テキスト: #FFFFFF, #D1D5DB (text-white, text-gray-300)
  - セカンダリテキスト: #9CA3AF (text-gray-400)

## タイポグラフィ

- **フォントファミリー**: "Inter", ui-sans-serif, system-ui, sans-serif
- **見出し**: 
  - H1: 2.25rem (text-4xl), font-bold/font-extrabold
  - H2: 1.875rem (text-3xl), font-bold
  - H3: 1.5rem (text-2xl), font-semibold
- **本文**: 1rem (text-base), font-normal
- **小テキスト**: 0.875rem (text-sm), font-normal
- **ボタンテキスト**: 1rem (text-base), font-medium

## デザイン要素

- **グラスモーフィズム**: backdrop-blur-sm効果でモダンな半透明要素
- **グラデーション**: 豊かなグラデーションをテキスト、ボタン、区切り線に使用
- **アニメーション**: 
  - トランジション: transition-all duration-300
  - ホバーエフェクト: group-hover:opacity-100
  - フォーカスエフェクト: focus:ring-2 focus:ring-purple-500
- **シャドウ**: shadow-xl, shadow-lg
- **角丸**: rounded-lg, rounded-md

## アクセシビリティ

- WCAG 2.1 AAレベルに準拠
- 高コントラストモードのサポート
- スクリーンリーダー対応（適切なaria属性）
- キーボードナビゲーション
- ダークモード最適化

## 状態とフィードバック

- **読み込み状態**: スケルトンローダー、グラデーションプログレスバー
- **エラー状態**: 明確なエラーメッセージと回復アクション
- **成功状態**: 視覚的確認とアニメーション
- **空の状態**: ガイダンスとアクションの提案
- **離脱安全状態**: パルスアニメーション付きインジケーター

## 状態遷移とユーザーフロー

UI設計は、ARCHITECTURE.mdで定義された状態遷移に基づいています：

```
[GitHub User名入力] → [状態確認]
  ↓
  ├── [2次調査結果あり] → [分析結果画面]
  │
  ├── [2次調査実行中] → [調査実行中画面] → [進捗更新] → [完了時] → [分析結果画面]
  │
  └── [2次調査未実行] → [1次調査実行] → [調査計画画面] → [実行ボタンクリック] → [調査実行中画面]
```

各状態に対応する画面遷移が設計されており、ユーザーがいつでも安全に離脱し、再訪問した際にも適切な画面に誘導されます。

## HTMLモック生成プロンプト例

以下のプロンプト等でHTMLを生成することができます:
```html
UI.md に合わせて画面案を html でページごとに mocks 出力して下さい
その際に以下を遵守して下さい
- Roo ModeはDesignerで実行して下さい
- デザインテイストは既存の apps/web のウェブサイトアプリに合わせて下さい
- ダークテーマベースのグラデーションリッチなデザイン
- Tailwind CSSを使用
- Interフォントを使用
- グラスモーフィズム効果を適用
```

生成したHTMLはHTMLディレクトリで `pnpm dlx http-server` を実行して閲覧できます

## 実装ギャップと今後の課題

このUI設計とモック案を実際の実装に移行するためには、以下の課題に対応する必要があります：

1. **ヘッダーとフッターの実装**: 現在の実装にはヘッダーとフッターが含まれていないため、これらのコンポーネントを実装する必要があります。

2. **グラデーションとアニメーション**: モック案で示されているリッチなグラデーションとアニメーション効果を実装する必要があります。

3. **グラスモーフィズム効果**: 半透明要素とbackdrop-blur効果を適用したグラスモーフィズムデザインを実装する必要があります。

4. **レスポンシブデザインの最適化**: 様々な画面サイズに対応するレスポンシブデザインを最適化する必要があります。

5. **アクセシビリティ対応**: WCAG 2.1 AAレベルに準拠するためのアクセシビリティ対応を実装する必要があります。

これらの課題に対応するために、PROGRESS.mdで定義された「UI実装ギャップ解消エピック」が計画されています。

## プロトタイプとモックアップ

詳細なモックアップとインタラクティブプロトタイプは以下で確認できます:

- Figmaプロジェクト: [リンク]
- プロトタイプデモ: [リンク]