# トラブルシューティングガイド

**更新日**: 2025/3/21
**確認日**: 2025/3/21

## 概要

git-resumeを使用する際に発生する可能性のある一般的な問題とその解決方法をまとめたガイドです。現在の実装に基づき、開発段階で遭遇しやすい問題に焦点を当てています。

## 目次

- [環境変数の問題](#環境変数の問題)
- [GitHubとの連携問題](#githubとの連携問題)
- [CLIツールの問題](#cliツールの問題)
- [Webアプリケーションの問題](#webアプリケーションの問題)
- [レジュメ生成の問題](#レジュメ生成の問題)
- [開発環境の問題](#開発環境の問題)
- [サポート情報](#サポート情報)

## 環境変数の問題

### 必要な環境変数が設定されていない

**症状**: 以下のようなエラーメッセージが表示される
- `GitHub Token not provided`
- `RESUME_GEMINI_API_KEY not set`

**解決策**:

1. `.env.sample`を参考に`.env`ファイルを作成
   ```bash
   cp .env.sample .env
   ```

2. 環境変数が正しく設定されているか確認
   ```bash
   # GitHub APIトークン
   export GITHUB_TOKEN=ghp_your_github_token
   
   # Google Gemini APIキー 
   export RESUME_GEMINI_API_KEY=your_gemini_api_key
   ```

3. ターミナルを再起動してセッションを更新

**原因**: 環境変数の設定が不足しているか、正しく読み込まれていません。

### GitHubトークンの権限不足

**症状**: `GitHub API returned: 401 Unauthorized`などのエラーメッセージが表示される

**解決策**:

1. GitHubの個人アクセストークンが有効で、正しいスコープを持っているか確認
2. 必要なスコープ: `repo`（パブリックリポジトリのみなら`public_repo`）
3. 新しいトークンを生成して試す: [GitHub Personal Access Tokens](https://github.com/settings/tokens)

**原因**: トークンの権限不足、有効期限切れ、または無効なトークンが使用されています。

## GitHubとの連携問題

### リポジトリのクローンに失敗する

**症状**: 
```
Error cloning repository: Error: Command failed: git clone https://github.com/...
```

**解決策**:

1. GitHubトークンが正しく設定されているか確認
2. リポジトリの存在とアクセス権を確認
3. パブリックリポジトリのみにアクセスする場合は`--public-only`オプションを使用
   ```bash
   git-resume clone repositories <username> --public-only
   ```
4. Gitの認証情報が正しく設定されているか確認

**原因**: 認証の問題、ネットワーク接続の問題、またはリポジトリのアクセス権の問題が考えられます。

### GitHubのAPIレート制限

**症状**: `GitHub API rate limit exceeded`というエラーメッセージが表示される

**解決策**:

1. GitHubトークンを使用する（認証済みユーザーは非認証ユーザーより高いレート制限を持つ）
2. しばらく待ってから再試行
3. 一度に処理するリポジトリの数を減らす

**原因**: GitHubのAPIリクエスト制限に達しました。[GitHubのレート制限](https://docs.github.com/en/rest/overview/resources-in-the-rest-api#rate-limiting)

## CLIツールの問題

### コマンドの実行に失敗する

**症状**: コマンド実行時にエラーが発生する

**解決策**:

1. CLIツールが正しくインストールされているか確認
   ```bash
   # モノレポ内で
   pnpm build --filter=cli
   
   # CLIコマンドのヘルプを表示
   pnpm --filter @resume/cli resume --help
   ```

2. コマンドとパラメータが正しいか確認
   ```bash
   # 正しい形式の例
   git-resume clone repositories <username>
   git-resume pack create <username>
   git-resume resume create <username>
   ```

**原因**: コマンド構文の誤り、パッケージのインストール問題、または依存関係の問題が考えられます。

### 生成されたファイルが見つからない

**症状**: レジュメ生成が成功したが、ファイルが見つからない

**解決策**:

1. ファイルの出力先を確認
   ```
   ../cli-github/generated/resumes/<username>.md
   ```

2. 必要なディレクトリが存在するか確認
   ```bash
   mkdir -p ../cli-github/generated/resumes/
   ```

**原因**: 出力ディレクトリが存在しないか、予期しない場所にファイルが生成されている可能性があります。

## Webアプリケーションの問題

### API接続エラー

**症状**: WebアプリからAPIに接続できない

**解決策**:

1. APIサーバーが実行中か確認
   ```bash
   pnpm dev --filter=api
   ```

2. APIエンドポイントが正しいか確認
   ```
   http://localhost:3001/api/github/getUser?userName=<username>
   ```

3. CORSの問題がないか確認
   - 開発環境では同一オリジンからのリクエストを確認
   - 別ポートから接続している場合はCORS設定を確認

**原因**: APIサーバーが実行されていない、URLが間違っている、またはCORSの問題が考えられます。

### Server-Sent Events (SSE) の接続問題

**症状**: リアルタイム更新が表示されない、またはエラーが発生する

**解決策**:

1. APIサーバーが実行中か確認
2. SSEエンドポイントが正しいか確認
   ```
   http://localhost:3001/api/github/<username>/progress
   ```
3. ブラウザのコンソールでエラーを確認（開発者ツール > Console）
4. ネットワークタブでSSE接続の状態を確認（開発者ツール > Network）

**原因**: サーバー接続の問題、SSEサポートの問題、またはイベントハンドリングの問題が考えられます。

## レジュメ生成の問題

### AI生成に関するエラー

**症状**: サマリーやレジュメの生成中にエラーが発生する
```
Error: Failed to generate summary with Gemini API
```

**解決策**:

1. Google Gemini APIキーが正しく設定されているか確認
2. APIキーの有効性と使用制限を確認
3. ネットワーク接続を確認
4. しばらく待ってから再試行

**原因**: API認証の問題、サービスの一時的な障害、またはレート制限に達した可能性があります。

### 生成されたレジュメの内容が不十分

**症状**: 生成されたレジュメが期待より薄い内容、または情報が不足している

**解決策**:

1. より多くのパブリックリポジトリを用意する
2. 有意義なコミット履歴とプロジェクト説明を持つリポジトリを使用する
3. `demo`ユーザー名を使用してモックデータでテスト
   ```
   git-resume resume create demo
   ```

**原因**: 分析対象のリポジトリが少ない、分析に十分な情報がない、またはAIモデルの制限が考えられます。

## 開発環境の問題

### 依存関係のインストールエラー

**症状**: `pnpm install`コマンドがエラーで失敗する

**解決策**:

1. pnpmのバージョンを確認（v10.4.1以上が必要）
   ```bash
   pnpm --version
   ```

2. Node.jsのバージョンを確認（v22.x以上が必要）
   ```bash
   node --version
   ```

3. ロックファイルを更新
   ```bash
   pnpm install --force
   ```

**原因**: バージョンの不一致、破損したロックファイル、またはパッケージの互換性の問題が考えられます。

### ビルドエラー

**症状**: `pnpm build`コマンドがエラーで失敗する

**解決策**:

1. 特定のパッケージのみをビルド
   ```bash
   pnpm build --filter=@resume/models
   pnpm build --filter=@resume/services
   ```

2. リントエラーを修正
   ```bash
   pnpm lint
   ```

3. TypeScriptエラーを確認
   ```bash
   p
# トラブルシューティングガイド

**更新日**: 2025/3/21
**確認日**: 2025/3/21

## 概要

git-resumeを使用する際に発生する可能性のある一般的な問題とその解決方法をまとめたガイドです。Web、CLI、API など各インターフェースでの問題解決方法を説明します。

## 目次

- [一般的な問題](#一般的な問題)
- [Webアプリケーションの問題](#webアプリケーションの問題)
- [CLIツールの問題](#cliツールの問題)
- [API関連の問題](#api関連の問題)
- [GitHubとの連携問題](#githubとの連携問題)
- [レジュメ生成の問題](#レジュメ生成の問題)
- [パフォーマンスの問題](#パフォーマンスの問題)
- [開発者向けトラブルシューティング](#開発者向けトラブルシューティング)
- [サポート情報](#サポート情報)

## 一般的な問題

### GitHubアカウント連携が失敗する

**症状**: GitHubとの連携時にエラーが表示される、またはページがリダイレクトループに入る

**解決策**:

1. ブラウザのCookieとキャッシュをクリア
2. ブラウザを再起動
3. インターネット接続を確認
4. 別のブラウザを試す
5. GitHub側でアプリケーションの承認を確認（[GitHubの設定ページ](https://github.com/settings/applications)）

**原因**: セッション情報の破損、ネットワーク問題、またはGitHubの認証設定の問題が考えられます。

### 環境変数の設定が認識されない

**症状**: CLIやローカル開発環境で環境変数を設定したのに認識されない

**解決策**:

1. 環境変数の構文が正しいか確認
   ```bash
   # macOS/Linux
   export GITHUB_TOKEN=your_token
   
   # Windows (CMD)
   set GITHUB_TOKEN=your_token
   
   # Windows (PowerShell)
   $env:GITHUB_TOKEN="your_token"
   ```

2. ターミナルやコマンドプロンプトを再起動
3. システム全体の環境変数として設定（永続化）
4. `.env`ファイルの場所が正しいか確認

**原因**: 環境変数の設定方法が誤っている、または環境変数の読み込みのタイミングの問題が考えられます。

## Webアプリケーションの問題

### ログインできない

**症状**: ログインボタンをクリックしても何も起こらない、またはエラーが表示される

**解決策**:

1. ブラウザのJavaScriptが有効になっているか確認
2. ブラウザを最新バージョンに更新
3. 別のブラウザを試す
4. プライベートブラウジングモードを試す
5. ブラウザの拡張機能を一時的に無効化（特にアドブロッカー）

**原因**: ブラウザの設定、互換性の問題、またはネットワークの問題が考えられます。

### データが表示されない

**症状**: ダッシュボードや情報ページが空白、またはローディング状態のまま

**解決策**:

1. ページを再読み込み
2. GitHubとの連携状態を確認（再連携が必要かもしれません）
3. ブラウザのコンソールでエラーを確認（開発者ツール > Console）
4. ログアウトして再度ログイン
5. ブラウザのキャッシュとCookieをクリア

**原因**: APIリクエストの失敗、GitHubのレート制限、またはクライアント側のキャッシュの問題が考えられます。

### レジュメのダウンロードができない

**症状**: レジュメのダウンロードボタンが機能しない、またはダウンロードが完了しない

**解決策**:

1. 別のファイル形式を試す（MarkdownからPDFなど）
2. ブラウザのダウンロード設定を確認
3. 別のブラウザを試す
4. ポップアップブロックが有効でないか確認
5. レジュメを再生成してから再試行

**原因**: ブラウザの設定、生成されたファイルの問題、またはサーバー側の問題が考えられます。

## CLIツールの問題

### インストールが失敗する

**症状**: `npm install -g @resume/cli` コマンドがエラーで失敗する

**解決策**:

1. Node.jsとnpmを最新バージョンに更新
   ```bash
   npm install -g npm
   ```

2. 権限の問題を解決（管理者権限で実行するか、グローバルnpmの設定を変更）
   ```bash
   # Mac/Linux (sudo使用)
   sudo npm install -g @resume/cli
   
   # または npm の設定を変更して sudo なしでグローバルインストール
   mkdir ~/.npm-global
   npm config set prefix '~/.npm-global'
   export PATH=~/.npm-global/bin:$PATH
   # ~/.profile または ~/.bash_profile に上記のパス設定を追加
   ```

3. npm キャッシュをクリア
   ```bash
   npm cache clean --force
   ```

4. npmレジストリが利用可能か確認
   ```bash
   npm ping
   ```

**原因**: Node.jsのバージョンの互換性、npmの設定の問題、またはネットワークの問題が考えられます。

### コマンドが見つからない

**症状**: `git-resume` コマンドを実行すると「コマンドが見つかりません」というエラーが表示される

**解決策**:

1. グローバルインストールが成功したか確認
   ```bash
   npm list -g @resume/cli
   ```

2. npmのグローバルバイナリディレクトリがPATHに含まれているか確認
   ```bash
   # パスを確認
   npm bin -g
   
   # 上記で取得したパスが PATH に含まれていることを確認
   echo $PATH  # Mac/Linux
   echo %PATH% # Windows (CMD)
   $env:PATH   # Windows (PowerShell)
   ```

3. CLIの特定バージョンをインストール
   ```bash
   npm install -g @resume/cli@latest
   ```

4. ローカルにインストールして使用
   ```bash
   npm install @resume/cli
   npx git-resume --version
   ```

**原因**: インストールパスの問題、環境変数の設定の問題、またはインストールが完了していないことが考えられます。

### GitHubトークンエラー

**症状**: GitHub関連のコマンドを実行すると認証エラーが発生する

**解決策**:

1. 環境変数にGitHubトークンが設定されているか確認
   ```bash
   # 環境変数を確認
   echo $GITHUB_TOKEN  # Mac/Linux
   echo %GITHUB_TOKEN% # Windows (CMD)
   $env:GITHUB_TOKEN   # Windows (PowerShell)
   ```

2. トークンが有効か確認（GitHubの個人アクセストークン設定ページで確認）
3. トークンに必要な権限（スコープ）が付与されているか確認
4. 新しいトークンを生成して試す
5. `.env`ファイルを使用している場合は、ファイルの場所と形式を確認

**原因**: トークンの期限切れ、権限不足、または環境変数の設定ミスが考えられます。

## API関連の問題

### API接続タイムアウト

**症状**: APIリクエストが完了せず、タイムアウトエラーが発生する

**解決策**:

1. ネットワーク接続を確認
2. API サーバーのステータスを確認（ステータスページがある場合）
3. ファイアウォールやプロキシの設定を確認
4. タイムアウト設定を長く設定（可能な場合）
5. リクエストのペイロードサイズを削減（大きなリクエストの場合）

**原因**: ネットワークの遅延、サーバーの過負荷、またはリクエストの複雑さが考えられます。

### APIレート制限エラー

**症状**: 「レート制限を超過しました」というエラーメッセージが表示される

**解決策**:

1. リクエストの頻度を下げる
2. 認証を使用する（認証済みリクエストは通常より高いレート制限が設定されている）
3. キャッシュを活用してAPIコール数を減らす
4. バッチ処理を使用して複数のリクエストをまとめる
5. レート制限がリセットされるまで待機（レスポンスヘッダーのX-RateLimit-Resetを確認）

**原因**: 短時間に多数のAPIリクエストを送信したため、GitHubのレート制限に達したことが考えられます。

## GitHubとの連携問題

### リポジトリアクセス権限エラー

**症状**: 特定のリポジトリにアクセスできないというエラーが発生する

**解決策**:

1. GitHubアカウントでリポジトリへのアクセス権があるか確認
2. プライベートリポジトリの場合、適切なスコープを持つトークンを使用しているか確認
3. リポジトリのURLが正しいか確認
4. 組織のリポジトリの場合、組織のアクセス権限を確認
5. GitHubアカウントの連携を解除して再連携

**原因**: 権限不足、リポジトリの可視性設定、またはトークンのスコープの問題が考えられます。

### GitHubデータの同期が遅い

**症状**: 最新のGitHubアクティビティがgit-resumeに反映されるまでに時間がかかる

**解決策**:

1. 手動でデータを更新（更新ボタンがある場合）
2. しばらく待ってから再試行（バックグラウンド同期処理がある場合）
3. ブラウザのキャッシュをクリア
4. セッションを更新（ログアウトして再ログイン）
5. キャッシュされたデータをクリア（CLIの場合は一時ファイルを削除）

**原因**: キャッシュの問題、バックグラウンド処理のスケジューリング、またはGitHubのAPI応答速度が考えられます。

## レジュメ生成の問題

### レジュメ生成が失敗する

**症状**: レジュメの生成処理が途中で失敗する、またはエラーメッセージが表示される

**解決策**:

1. 対象リポジトリの数を減らして再試行
2. 特定のリポジトリを除外して再試行（問題のあるリポジトリがある可能性）
3. 別の出力形式を選択（MarkdownやHTMLなど）
4. ログを確認して具体的なエラー原因を特定（CLIの場合はデバッグモードを有効化）
   ```bash
   git-resume resume create --user <username> --debug
   ```
5. GitHubのレート制限に達していないか確認

**原因**: リポジトリのサイズや内容、APIレート制限、出力形式の処理の問題が考えられます。

### レジュメの内容が不完全

**症状**: 生成されたレジュメにデータの欠落や不正確な情報がある

**解決策**:

1. より多くのリポジトリを分析対象に含める
2. プライベートリポジトリも含める（権限がある場合）
3. 異なる分析オプションを試す
4. GitHubプロフィールの情報を更新
5. 手動でレジュメを編集して補完

**原因**: 分析対象のリポジトリの制限、GitHubデータの不足、または分析アルゴリズムの限界が考えられます。

## パフォーマンスの問題

### Webアプリケーションの応答が遅い

**症状**: ページの読み込みが遅い、UIの応答性が低い

**解決策**:

1. ブラウザのキャッシュをクリア
2. 他のブラウザタブやアプリケーションを閉じてリソースを解放
3. ブラウザを最新バージョンに更新
4. インターネット接続速度を確認
5. 低スペックデバイスの場合、「軽量モード」があれば使用

**原因**: クライアント側のリソース不足、ネットワークの遅延、またはサーバーの応答速度が考えられます。

### 大規模リポジトリの処理に時間がかかる

**症状**: 大きなリポジトリの分析時に処理が長時間完了しない

**解決策**:

1. 分析対象を特定のディレクトリや期間に限定（オプションがある場合）
2. ファイル数の少ないリポジトリから試す
3. CLIツールを使用してローカル処理（Webアプリより高速な場合がある）
4. タイムアウト設定を長く設定（可能な場合）
5. バックグラウンド処理としてジョブを実行し、完了通知を受け取る設定にする

**原因**: リポジトリのサイズ、複雑さ、または処理リソースの制限が考えられます。

## 開発者向けトラブルシューティング

### 開発環境のセットアップ問題

**症状**: `pnpm install` や `pnpm dev` コマンドがエラーで失敗する

**解決策**:

1. pnpmを最新バージョンに更新
   ```bash
   npm install -g pnpm
   ```

2. Node.jsのバージョンがプロジェクト要件を満たしているか確認
   ```bash
   node -v  # v22.x以上が必要
   ```

3. 依存関係のキャッシュをクリア
   ```bash
   pnpm store prune
   ```

4. リポジトリを新たにクローンし直す
5. エラーメッセージを詳細に確認し、特定のパッケージの問題を解決

**原因**: 依存関係の競合、Node.jsのバージョンの不一致、またはpnpmの設定の問題が考えられます。

### ビルドエラー

**症状**: `pnpm build` コマンドがエラーで失敗する

**解決策**:

1. 構文エラーや型エラーを修正（ログを確認）
2. 最新の変更をプルしてマージ競合を解決
3. Biomeやその他のリントツールを実行して問題を特定
   ```bash
   pnpm lint
   ```
4. キャッシュをクリアしてビルドし直す
   ```bash
   pnpm clean && pnpm build
   ```
5. 特定のパッケージのみをビルド
   ```bash
   pnpm build --filter=api
   ```

**原因**: コードの構文エラー、型の不一致、または依存関係の問題が考えられます。

### Turborepoのパイプライン問題

**症状**: Turborepoのパイプラインが正しく実行されない

**解決策**:

1. `turbo.json` の設定を確認
2. Turborepoのキャッシュをクリア
   ```bash
   pnpm dlx turbo clean
   ```
3. パッケージの依存関係が正しく設定されているか確認
4. 特定のタスクを単独で実行してデバッグ
5. Turborepoのバージョンを更新

**原因**: タスク定義の問題、依存関係の誤設定、またはキャッシュの問題が考えられます。

## サポート情報

問題が解決しない場合は、以下の方法でサポートを受けることができます：

1. **GitHub Issue**: [GitHubリポジトリ](https://github.com/ToyB0x/git-resume/issues)に問題を報告
2. **ドキュメント**: [プロジェクト概要](/docs/guide/project-overview.md)や[API仕様書](/docs/api/README.md)を参照
3. **コミュニティ**: 開発者コミュニティに質問（準備中）

バグ報告やフィードバックを送信する際は、以下の情報を含めてください：

- 使用しているインターフェース（Web/CLI/API）とバージョン
- 発生している問題の詳細な説明
- 問題を再現するための手順
- エラーメッセージやスクリーンショット（可能であれば）
- 使用環境（OS、ブラウザのバージョンなど）

## Changelog

- 2025/3/21: 初回作成
