# ドキュメント検証プロンプトガイド

**更新日**: 2025/3/24
**確認日**: 2025/3/24

## 目的

- ドキュメントの品質と一貫性を検証するための効果的なプロンプトパターンを提供する
- 検証プロンプトの使用例と結果の解釈方法を詳細に説明する
- 一般的な問題パターンとその解決方法を紹介する
- ドキュメント品質の継続的な改善を支援する

## 検証システムの概要

AIプロンプトベースの検証システムは、LLM（大規模言語モデル）を活用してドキュメントの品質と一貫性を検証するためのシステムです。このシステムは、特定の形式のプロンプトを使用してLLMに指示を出し、ドキュメントの検証を行います。

検証システムの主な特徴：
- 特定のプロンプトパターンを使用して検証を実行
- メタデータ、フォーマット、リンク、参照、構造の一貫性を検証
- 問題点の特定と改善提案の生成
- 人間とAIの協働による継続的な品質改善

## 検証プロンプトの基本形式

AIプロンプトベースの検証システムでは、以下の基本形式を使用します：

```
@[ルールパス] @[検証対象パス]
```

例：
```
@/docs/rules/README.md の全ルールを @docs/rules/validation.md の方針に従い @docs/ docs配下のドキュメント全体に適用してください
```

この形式では：
- `@[ルールパス]`: 適用するルールが記載されているファイルのパス
- `@[検証対象パス]`: 検証対象のディレクトリやファイルのパス

## 検証シナリオと実践例

以下に、一般的な検証シナリオと、それに対応する具体的なプロンプト例を示します。各シナリオには、プロンプト例、期待される結果、結果の解釈方法が含まれています。

### シナリオ1: 新規ドキュメントの包括的検証

**状況**: 新しく作成された製品機能のドキュメントセットを包括的に検証する必要があります。

**プロンプト例**:
```
@/docs/rules/README.md の全ルールを @docs/rules/validation.md の方針に従い @docs/product/features/new-feature/ 配下のドキュメント全体に適用してください。特にメタデータの完全性、リンクの有効性、構造の一貫性に注目してください。
```

**期待される結果**:
- メタデータ、フォーマット、リンク、参照、構造の各カテゴリに関する検証結果
- 発見された問題点のリスト
- 具体的な改善提案

**結果の解釈と活用**:
1. 最も重要な問題（メタデータ不足、リンク切れなど）を優先的に修正
2. 同様のパターンで発生している問題がある場合は、テンプレートや作成プロセスの見直しを検討
3. 改善提案を実装し、再検証を実施

### シナリオ2: リンク切れの検出と修正

**状況**: ドキュメント構造の変更後、リンク切れが発生している可能性があります。

**プロンプト例**:
```
@docs/rules/links.md のリンクルールに従って @docs/ 配下のドキュメントのリンクを検証し、リンク切れを検出してください。検出されたリンク切れについては、正しいリンク先の提案も行ってください。
```

**期待される結果**:
- リンク切れの一覧（ファイルパスとリンクテキスト）
- 各リンク切れに対する修正提案
- リンク構造の改善提案

**結果の解釈と活用**:
1. 提案された修正を実装（特に重要なドキュメントのリンクを優先）
2. リンク管理プロセスの見直し（相対パスの使用方法など）
3. 自動リンクチェックの導入検討

### シナリオ3: メタデータの一貫性検証

**状況**: プロジェクト全体でメタデータの一貫性を確保したい。

**プロンプト例**:
```
@docs/rules/documents/metadata.md のメタデータルールに従って @docs/ 配下のすべてのドキュメントのメタデータを検証し、不足しているメタデータ、形式が不正なメタデータ、古いメタデータを特定してください。
```

**期待される結果**:
- メタデータが不足しているドキュメントのリスト
- 形式が不正なメタデータのリスト（日付形式など）
- 最終更新日が古いドキュメントのリスト

**結果の解釈と活用**:
1. 不足しているメタデータを追加
2. 形式が不正なメタデータを修正
3. 古いドキュメントの更新または確認日の更新

### シナリオ4: ドキュメント構造の検証

**状況**: ドキュメント構造がルールに準拠しているか確認したい。

**プロンプト例**:
```
@docs/rules/structure.md のドキュメント構造ルールに従って @docs/product/ 配下のディレクトリ構造を検証し、ルールに準拠していない構造を特定してください。また、改善提案も行ってください。
```

**期待される結果**:
- ルールに準拠していないディレクトリ構造のリスト
- 不適切なファイル配置の指摘
- 構造改善の具体的な提案

**結果の解釈と活用**:
1. 提案された構造改善を実装
2. 必要に応じてディレクトリ構造を再編成
3. README.mdファイルの追加や更新

### シナリオ5: 特定ドキュメントの詳細検証

**状況**: 重要なドキュメント（例：README.md）の詳細な検証を行いたい。

**プロンプト例**:
```
@/docs/rules/README.md の全ルールを @docs/rules/validation.md の方針に従い @docs/README.md に適用し、詳細な検証を行ってください。特に内容の網羅性、最新性、読みやすさの観点からも評価してください。
```

**期待される結果**:
- 標準的な検証項目（メタデータ、リンクなど）の結果
- 内容の網羅性に関する評価
- 最新性に関する評価
- 読みやすさに関する評価と改善提案

**結果の解釈と活用**:
1. 技術的な問題（リンク切れなど）の修正
2. 内容の更新や追加
3. 構造や表現の改善

## 効果的な検証プロンプトの作成方法

効果的な検証プロンプトを作成するためのガイドラインを以下に示します：

### 1. 明確な目的と範囲の指定

良いプロンプト例：
```
@docs/rules/documents/metadata.md のメタデータルールに従って @docs/product/features/ 配下のドキュメントのメタデータを検証してください
```

改善が必要なプロンプト例：
```
ドキュメントを検証してください
```

### 2. 適切な粒度の設定

良いプロンプト例：
```
@docs/rules/links.md のリンクルールに従って @docs/product/features/new-feature/ 配下のドキュメントのリンクを検証してください
```

改善が必要なプロンプト例：
```
@/docs/rules/README.md の全ルールを @docs/ 配下のすべてのドキュメントに適用してください
```
（範囲が広すぎて詳細な結果が得られない可能性があります）

### 3. 優先事項の明示

良いプロンプト例：
```
@/docs/rules/README.md の全ルールを @docs/product/features/new-feature/ 配下のドキュメントに適用してください。特にメタデータの完全性とリンクの有効性を重点的に確認してください。
```

改善が必要なプロンプト例：
```
@/docs/rules/README.md の全ルールを @docs/product/features/new-feature/ 配下のドキュメントに適用してください
```
（優先事項が明示されていません）

### 4. コンテキスト情報の提供

良いプロンプト例：
```
最近ドキュメント構造を変更したため、@docs/rules/links.md のリンクルールに従って @docs/ 配下のドキュメントのリンクを検証し、リンク切れを検出してください。
```

改善が必要なプロンプト例：
```
リンク切れを検出してください
```
（背景情報が不足しています）

## 検証結果の解釈と活用

検証結果を最大限に活用するためのガイドラインを以下に示します：

### 1. 優先順位付け

検証結果に含まれる問題を以下の基準で優先順位付けします：

- **重大度**: ドキュメントの使用に影響を与える程度
  - 高: リンク切れ、重要なメタデータの欠落
  - 中: フォーマットの不一致、参照の不整合
  - 低: 軽微なスタイルの問題

- **影響範囲**: 問題が影響するドキュメントの範囲
  - 広: 多数のドキュメントに影響
  - 中: 特定のセクションに影響
  - 狭: 単一のドキュメントのみに影響

- **修正の容易さ**: 問題を修正するための労力
  - 高: 自動的または簡単に修正可能
  - 中: 手動での修正が必要だが複雑ではない
  - 低: 複雑な修正が必要

### 2. パターンの特定

検証結果から共通のパターンを特定し、根本原因に対処します：

- 同じ種類の問題が複数のドキュメントで発生している場合、テンプレートや作成プロセスの見直しを検討
- 特定のディレクトリやドキュメント種別に問題が集中している場合、そのカテゴリに特化したガイドラインの強化を検討
- 時間の経過とともに増加している問題がある場合、定期的なメンテナンスプロセスの見直しを検討

### 3. 継続的改善

検証結果を継続的改善のサイクルに組み込みます：

1. **検証**: AIプロンプトベースの検証システムを使用して問題を特定
2. **分析**: 問題のパターンと根本原因を分析
3. **計画**: 修正と改善の計画を策定
4. **実装**: 修正と改善を実施
5. **再検証**: 変更後に再度検証を実施
6. **学習**: プロセスから学び、ルールやガイドラインを改善

## 定期的な検証プロセスの確立

効果的なドキュメント品質管理のために、以下の定期的な検証プロセスを確立することを推奨します：

### 日常的な検証

- **更新時検証**: ドキュメント更新時に、更新者が関連するルールに基づいて検証
- **コミット前検証**: 重要な変更をコミットする前に、影響範囲に応じた検証を実行

### 定期的な検証

- **週次検証**: 週に1回、新規追加・更新されたドキュメントの検証
- **月次検証**: 月に1回、特定のカテゴリ（例：製品ドキュメント）の完全検証
- **四半期検証**: 四半期に1回、すべてのドキュメントの完全検証

### イベントベースの検証

- **リリース前検証**: 製品リリース前に関連ドキュメントの完全検証
- **構造変更後検証**: ドキュメント構造変更後に全体の整合性検証
- **ルール更新後検証**: ドキュメントルール更新後に影響範囲の検証

## 一般的な問題パターンと解決方法

### 1. メタデータの不足または不正確

**問題例**:
- 更新日や確認日が記載されていない
- バージョン番号の形式が不統一
- ステータスが明記されていない

**解決方法**:
- ドキュメントテンプレートにメタデータセクションを標準で含める
- 自動チェックツールを導入して、コミット前にメタデータを検証
- ドキュメント作成・更新ワークフローにメタデータ確認ステップを追加

### 2. リンク切れ

**問題例**:
- ファイル移動や名前変更によるリンク切れ
- 相対パスの誤りによるリンク切れ
- 外部リンクの無効化

**解決方法**:
- 相対パスの使用を標準化
- ファイル移動時のリンク更新チェックリストを作成
- 定期的なリンク検証を実施
- 重要な外部リンクの定期的な確認

### 3. 構造の不一致

**問題例**:
- ディレクトリ構造がルールに準拠していない
- README.mdファイルが不足している
- ファイル命名規則が不統一

**解決方法**:
- ディレクトリ構造テンプレートの提供
- 新規ディレクトリ作成時のチェックリストの作成
- 自動構造検証ツールの導入

### 4. 内容の古さ

**問題例**:
- 古い情報や廃止された機能の説明が残っている
- 最新の変更が反映されていない
- 確認日が古い

**解決方法**:
- 定期的なドキュメントレビューサイクルの確立
- コードとドキュメントの同時更新ルールの強化
- 「最終確認日」の定期的な更新

## AIインストラクション

このガイドを読んだAIは以下の行動をとってください：

- 検証プロンプトの基本形式と使用例を理解し、適切なプロンプトを構成する
- 検証結果を構造化し、問題点と改善案を明確に提示する
- 定期的な検証プロセスの重要性を理解し、適切な頻度と範囲を提案する
- 問題のパターンを特定し、根本原因に対する解決策を提案する
- 人間との協働を前提とした検証アプローチを採用する

## メタデータ

**更新・確認情報**:
- 最終更新日: 2025/03/24
- 最終確認日: 2025/03/24

**文書情報**:
- ステータス: 承認済み
- バージョン: 1.0.0

## 関連ドキュメント

- [プロンプトガイド](./README.md)
- [ドキュメント検証システム](../../../rules/validation.md)
- [ドキュメントメタデータ標準](../../../rules/documents/metadata.md)
- [ドキュメントルールの適用計画と進捗状況](../../../PLAN_AND_PROGRESS.md)

## Changelog

- 2025/3/24: [変更] docs/guide/developer/validation/から移動し、内容を統合
- 2025/3/24: [追加] 初回作成