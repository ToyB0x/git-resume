# AIのコミットルール

**更新日**: 2025/3/23
**確認日**: 2025/3/23

## 目的

- AIが適切にコミットの提案とメッセージを記録するためのルールを定義する
- コミット履歴の一貫性と可読性を確保する
- プロンプト履歴を含めることで、変更の背景と意図を明確にする
- チーム全体での変更理解を促進する

## コミットルール

### 必ず遵守すべきポイント

✅ **積極的な提案**: 作業完了時には必ずコミットを提案する  
✅ **標準形式の遵守**: 「種類: 要約」の形式で、詳細な説明と変更ファイル一覧を含める  
✅ **プロンプト履歴の記録**: プロンプト履歴をコミットメッセージに含める  
✅ **ユーザー承認**: コミット提案時にはユーザーの承認を得る  

### コミットメッセージの構造

```
<種類>: <要約>

<詳細な説明>

## 変更ファイル
- <ファイルパス1>: <変更内容の簡単な説明>
- <ファイルパス2>: <変更内容の簡単な説明>
...

## プロンプト履歴
1. ユーザー: <プロンプト内容>
2. AI: <回答の要約>
3. ユーザー: <フィードバック内容>
...
```

### 変更種類の定義

- **feat**: 新機能の追加
- **fix**: バグ修正
- **docs**: ドキュメントのみの変更
- **style**: コードの意味に影響を与えない変更（空白、フォーマット、セミコロンの欠落など）
- **refactor**: バグ修正や機能追加ではないコード変更
- **test**: テストの追加または修正
- **chore**: ビルドプロセスやツールの変更、依存関係の更新など

### 良いコミットメッセージの例

```
feat: レジュメ生成機能にテンプレート選択オプションを追加

ユーザーが複数のテンプレートから選択できるようにレジュメ生成機能を拡張しました。
デフォルトで3つのテンプレート（シンプル、詳細、技術的）を提供し、
カスタムテンプレートのアップロード機能も追加しました。

## 変更ファイル
- apps/web/app/routes/resume-generator.tsx: テンプレート選択UIの追加
- packages/services/src/resume/create.ts: テンプレート処理ロジックの実装
- packages/models/src/resume.ts: テンプレート関連のモデル定義を追加

## プロンプト履歴
1. ユーザー: レジュメ生成機能にテンプレート選択機能を追加してください
2. AI: テンプレート選択UIとバックエンド処理の実装を提案
3. ユーザー: カスタムテンプレートのアップロード機能も追加してください
4. AI: カスタムテンプレート機能の実装完了
```

### 避けるべき悪い例

```
変更を追加

レジュメ機能を修正しました。
```

問題点:
- 変更種類が明示されていない
- 要約が抽象的すぎる
- 詳細な説明がない
- 変更ファイル一覧がない
- プロンプト履歴がない

## 複数の変更を含むコミット

複数の論理的な変更がある場合は、以下のいずれかの方法を選択してください：

1. **関連する変更をグループ化**: 同じ機能や修正に関連する変更は1つのコミットにまとめる
2. **独立した変更を分割**: 独立した変更は別々のコミットに分割することを提案する

例：
```
ユーザー: レジュメ生成機能の改善とログイン画面のバグ修正をお願いします

AI: これらは独立した2つの変更なので、別々のコミットに分けることを提案します：
1. feat: レジュメ生成機能の改善
2. fix: ログイン画面のバグ修正
```

## コミット提案のタイミング

以下のタイミングでコミットを提案してください：

1. **機能実装の完了時**: 新機能の実装が完了した時点
2. **バグ修正の完了時**: バグの修正が完了した時点
3. **リファクタリングの完了時**: コードの改善が完了した時点
4. **ドキュメント更新の完了時**: ドキュメントの更新が完了した時点
5. **複数の変更を行った場合**: 論理的なまとまりごとに分割して提案

## AIインストラクション

このルールを読んだAIは以下の行動をとってください：

- 作業完了時に「種類: 要約」形式のコミットを提案し、詳細説明・変更ファイル一覧・プロンプト履歴を含める
- ユーザー承認を得てから実行し、複数変更は論理的なまとまりでコミット単位を提案する
- 変更種類（feat/fix/docs/style/refactor/test/chore）を適切に選択する
- コミットメッセージは具体的かつ明確に記述し、変更の意図と影響を理解しやすくする
- プロンプト履歴は簡潔にまとめつつ、重要なやり取りを漏らさないようにする

## Changelog

- 2025/3/23: 初回作成